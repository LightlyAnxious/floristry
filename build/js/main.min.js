const DESKTOP=1140,TABLET=767,ENTER_KEYCODE=13,ESC_KEYCODE=27,menuBtn=document.querySelector(".page-header__btn"),menuOverlay=document.querySelector(".menu-overlay"),modal=document.querySelector(".modal"),modalOverlay=document.querySelector(".modal-overlay"),contactForm=document.querySelector(".contact-form__fields"),servicesList=document.querySelector(".services__list"),callButton=document.querySelector("#call-button"),modalClose=document.querySelector(".contact-form__close"),introBg=document.querySelector(".intro__bg-image"),galleryImages=document.querySelectorAll(".gallery__item"),cardSlides=document.querySelectorAll(".card__slide"),modalSlider=document.querySelector(".modal-slider"),galleryCloseBtn=document.querySelector(".modal-slider__close-btn"),desktop=window.matchMedia("(min-width: 1140px)"),msnryGrid=document.querySelector(".grid");let slideTemplate=document.querySelector("#modal-slider-template"),winX=null,winY=null,step=1;const onEscEvent=function(e,l){27===e.keyCode&&l()},openModal=(e,l)=>{e.classList.add("modal--open"),e.setAttribute("aria-modal",!0),e.removeAttribute("aria-hidden"),modalOverlay&&(modalOverlay.style.display="block"),disableWindowScroll(),focusManager.capture(l)},closeModal=(e,l)=>{e.classList.contains("modal--open")&&(e.classList.remove("modal--open"),e.removeAttribute("aria-modal"),e.setAttribute("aria-hidden",!0),enableWindowScroll(),focusManager.release(l)),modalOverlay&&(modalOverlay.style.display="none")};function disableWindowScroll(){winX=window.scrollX,winY=window.scrollY}function enableWindowScroll(){winX=null,winY=null}if(window.addEventListener("scroll",(function(){null!==winX&&null!==winY&&window.scrollTo(winX,winY)})),msnryGrid){const e=document.querySelector(".grid");let l=new Masonry(e,{columnWidth:".grid-sizer",itemSelector:".grid-item",percentPosition:!0,transitionDuration:"0.2s"});function doMasonry(){l.layout()}document.addEventListener("DOMContentLoaded",()=>yall({events:{load:function(e){e.target.classList.contains("gallery__image--unloaded")&&(e.target.classList.remove("gallery__image--unloaded"),window.setTimeout(doMasonry,300))}},options:{once:!0}}))}else document.addEventListener("DOMContentLoaded",()=>yall({observeChanges:!0,noPolyfill:!0}));if(menuBtn&&menuOverlay){const e=()=>{menuBtn.classList.toggle("page-header__btn--close"),menuBtn.classList.toggle("page-header__btn--open"),menuOverlay.classList.toggle("menu-overlay--shown"),menuOverlay.classList.contains("menu-overlay--shown")?(disableWindowScroll(),focusManager.capture(menuOverlay)):(enableWindowScroll(),focusManager.release(menuOverlay))},l=()=>{menuOverlay.classList.contains("menu-overlay--shown")&&(menuOverlay.classList.remove("menu-overlay--shown"),menuBtn.classList.toggle("page-header__btn--close"),menuBtn.classList.toggle("page-header__btn--open"))};menuBtn.addEventListener("click",e),window.addEventListener("keydown",e=>{onEscEvent(e,l)})}null!==introBg&&window.addEventListener("scroll",()=>{let e=window.scrollY;introBg.style.top=.5*e+"px"}),callButton&&modal&&modalClose&&modalOverlay&&(callButton.addEventListener("click",()=>openModal(modal,contactForm)),modalClose.addEventListener("click",()=>closeModal(modal,callButton)),modalOverlay.addEventListener("click",()=>closeModal(modal,callButton)),window.addEventListener("keydown",e=>{onEscEvent(e,closeModal(modal,callButton))}));const manageControls=(e,l,n,t,a)=>{const o=document.querySelector(e),r=document.querySelector(l);o&&n&&t>0&&(o.style.display="block",r.style.display="block"),o&&n&&0===t&&(o.style.display="none",r.style.display="block"),o&&n&&t===a-1&&(r.style.display="none")};let servicesSlider;const breakpointChecker=function(){if(!0!==desktop.matches)return!1===desktop.matches?enableSwiper():void 0;void 0!==servicesSlider&&servicesList&&servicesSlider.destroy(!0,!0)},enableSwiper=function(){servicesSlider=new Swiper(".swiper1",{a11y:!0,paginationBulletMessage:"Перейти к слайду {{index}}",breakpoints:{250:{pagination:{el:".swiper-pagination",clickable:!0,renderBullet:function(e,l){return'<button class="'+l+'" aria-label= "Перейти к слайду '+e+'">Перейти к слайду '+e+"</button>"}},slidesPerView:1,slidesPerGroup:1,spaceBetween:28,initialSlide:0,setWrapperSize:!0,grabCursor:!0,updateOnWindowResize:!0,centeredSlides:!0,centeredSlidesBounds:!0},768:{pagination:{el:".swiper-pagination",clickable:!0,renderBullet:function(e,l){return'<button class="'+l+'" aria-label= "Перейти к слайду '+e+'">Перейти к слайду '+e+"</button>"}},slidesPerView:2,slidesPerGroup:2,initialSlide:0,setWrapperSize:!0,grabCursor:!0,updateOnWindowResize:!0,cssWidthAndHeight:!0}}})};desktop.addListener(breakpointChecker),breakpointChecker();let cardsSlider=new Swiper(".swiper2",{slidesPerView:4,slidesPerGroup:4,initialSlide:0,spaceBetween:20,a11y:!0,paginationBulletMessage:"Перейти к слайду {{index}}",keyboardControl:!0,grabCursor:!0,updateOnWindowResize:!0,navigation:{nextEl:".card__control--next",prevEl:".card__control--prev"},breakpoints:{250:{spaceBetween:15,initialSlide:0,keyboardControl:!0,grabCursor:!0,updateOnWindowResize:!0},384:{initialSlide:0,on:{beforeResize(){window.innerWidth>=384&&cardsSlider.slides.css("width","")}}},768:{slidesPerView:4,slidesPerGroup:4,initialSlide:0,spaceBetween:23,setWrapperSize:!0,keyboardControl:!0,grabCursor:!0,updateOnWindowResize:!0,cssWidthAndHeight:!0},1141:{spaceBetween:9},1300:{spaceBetween:12},1500:{spaceBetween:16}}});cardsSlider.on("slideChange",()=>manageControls(".card__control--prev",".card__control--next",cardsSlider,cardsSlider.realIndex,cardSlides.length));let modalSliderOptions={slidesPerView:1,slidesPerGroup:1,a11y:!0,initialSlide:0,observer:!0,updateOnWindowResize:!0,navigation:{nextEl:".modal-btn--next",prevEl:".modal-btn--prev"},fadeEffect:{crossFade:!0}};const gallerySlider=new Swiper(".swiper3",modalSliderOptions);if(modal&&galleryImages&&modalSlider){let e=document.querySelector(".swiper-wrapper");if(slideTemplate){const l=Array.from(galleryImages);let n,t;const a=l=>{let a=slideTemplate.content.querySelector(".modal-slider__picture").cloneNode(!0),o=a.querySelector("source"),r=a.querySelector("img"),i=window.innerWidth,d=document.createElement("li");d.classList.add("modal-slider__item"),d.classList.add("swiper-slide"),i>767?(n=`img/gallery/tablet/gallery-img-${l}--tablet.webp 1x, img/gallery/tablet/gallery-img-${l}--tablet@2x.webp 2x`,t=`img/gallery/tablet/gallery-img-${l}--tablet.jpg`,o.dataset.srcset=n,r.dataset.src=t,d.appendChild(a),e.appendChild(d)):(n=`img/gallery/mobile/gallery-img-${l}--mobile.webp 1x, img/gallery/mobile/gallery-img-${l}--mobile@2x.webp 2x`,t=`img/gallery/mobile/gallery-img-${l}--mobile.jpg`,o.dataset.srcset=n,r.dataset.src=t,d.appendChild(a),e.appendChild(d))},o=(l,n)=>{e.innerHTML="";for(let e=1;e<=galleryImages.length;e++)a(e);n.update(),n.slideTo(l)};l.forEach((e,l)=>{e.addEventListener("click",()=>{o(l,gallerySlider),openModal(modal,modalSlider),manageControls(".modal-btn--prev",".modal-btn--next",gallerySlider,gallerySlider.realIndex,galleryImages.length),yall()})}),galleryCloseBtn.addEventListener("click",()=>closeModal(modal,window)),modalOverlay.addEventListener("click",()=>closeModal(modal,window)),gallerySlider.on("slideChange",()=>{manageControls(".modal-btn--prev",".modal-btn--next",gallerySlider,gallerySlider.realIndex,galleryImages.length)})}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiREVTS1RPUCIsIlRBQkxFVCIsIkVOVEVSX0tFWUNPREUiLCJFU0NfS0VZQ09ERSIsIm1lbnVCdG4iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51T3ZlcmxheSIsIm1vZGFsIiwibW9kYWxPdmVybGF5IiwiY29udGFjdEZvcm0iLCJzZXJ2aWNlc0xpc3QiLCJjYWxsQnV0dG9uIiwibW9kYWxDbG9zZSIsImludHJvQmciLCJnYWxsZXJ5SW1hZ2VzIiwicXVlcnlTZWxlY3RvckFsbCIsImNhcmRTbGlkZXMiLCJtb2RhbFNsaWRlciIsImdhbGxlcnlDbG9zZUJ0biIsImRlc2t0b3AiLCJ3aW5kb3ciLCJtYXRjaE1lZGlhIiwibXNucnlHcmlkIiwic2xpZGVUZW1wbGF0ZSIsIndpblgiLCJ3aW5ZIiwic3RlcCIsIm9uRXNjRXZlbnQiLCJldnQiLCJhY3Rpb24iLCJrZXlDb2RlIiwib3Blbk1vZGFsIiwiZWwiLCJjYXB0dXJlIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwic3R5bGUiLCJkaXNwbGF5IiwiZGlzYWJsZVdpbmRvd1Njcm9sbCIsImZvY3VzTWFuYWdlciIsImNsb3NlTW9kYWwiLCJjb250YWlucyIsInJlbW92ZSIsImVuYWJsZVdpbmRvd1Njcm9sbCIsInJlbGVhc2UiLCJzY3JvbGxYIiwic2Nyb2xsWSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzY3JvbGxUbyIsImdyaWQiLCJtc25yeSIsIk1hc29ucnkiLCJjb2x1bW5XaWR0aCIsIml0ZW1TZWxlY3RvciIsInBlcmNlbnRQb3NpdGlvbiIsInRyYW5zaXRpb25EdXJhdGlvbiIsImRvTWFzb25yeSIsImxheW91dCIsInlhbGwiLCJldmVudHMiLCJsb2FkIiwiZXZlbnQiLCJ0YXJnZXQiLCJzZXRUaW1lb3V0Iiwib3B0aW9ucyIsIm9uY2UiLCJvYnNlcnZlQ2hhbmdlcyIsIm5vUG9seWZpbGwiLCJvbkNsaWNrTWVudVRvZ2dsZSIsInRvZ2dsZSIsImNsb3NlTWVudSIsInZhbHVlIiwidG9wIiwibWFuYWdlQ29udHJvbHMiLCJwcmV2Q3NzQ2xhc3MiLCJuZXh0Q3NzQ2xhc3MiLCJjdXJyZW50U2xpZGVyIiwiaW5kZXgiLCJsZW5ndGgiLCJwcmV2QnRuIiwibmV4dEJ0biIsInNlcnZpY2VzU2xpZGVyIiwiYnJlYWtwb2ludENoZWNrZXIiLCJtYXRjaGVzIiwiZW5hYmxlU3dpcGVyIiwidW5kZWZpbmVkIiwiZGVzdHJveSIsIlN3aXBlciIsImExMXkiLCJwYWdpbmF0aW9uQnVsbGV0TWVzc2FnZSIsImJyZWFrcG9pbnRzIiwiMjUwIiwicGFnaW5hdGlvbiIsImNsaWNrYWJsZSIsInJlbmRlckJ1bGxldCIsImNsYXNzTmFtZSIsInNsaWRlc1BlclZpZXciLCJzbGlkZXNQZXJHcm91cCIsInNwYWNlQmV0d2VlbiIsImluaXRpYWxTbGlkZSIsInNldFdyYXBwZXJTaXplIiwiZ3JhYkN1cnNvciIsInVwZGF0ZU9uV2luZG93UmVzaXplIiwiY2VudGVyZWRTbGlkZXMiLCJjZW50ZXJlZFNsaWRlc0JvdW5kcyIsIjc2OCIsImNzc1dpZHRoQW5kSGVpZ2h0IiwiYWRkTGlzdGVuZXIiLCJjYXJkc1NsaWRlciIsImtleWJvYXJkQ29udHJvbCIsIm5hdmlnYXRpb24iLCJuZXh0RWwiLCJwcmV2RWwiLCIzODQiLCJvbiIsIltvYmplY3QgT2JqZWN0XSIsImlubmVyV2lkdGgiLCJzbGlkZXMiLCJjc3MiLCIxMTQxIiwiMTMwMCIsIjE1MDAiLCJyZWFsSW5kZXgiLCJtb2RhbFNsaWRlck9wdGlvbnMiLCJvYnNlcnZlciIsImZhZGVFZmZlY3QiLCJjcm9zc0ZhZGUiLCJnYWxsZXJ5U2xpZGVyIiwiZ2FsbGVyeUxpc3QiLCJpbWFnZXMiLCJBcnJheSIsImZyb20iLCJzcmNTZXQiLCJzcmMiLCJnZXRMYXp5U2xpZGUiLCJzbGlkZUVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwic2xpZGVTb3VyY2UiLCJzbGlkZUltZyIsInZpZXdQb3J0IiwiZ2FsbGVyeUl0ZW0iLCJjcmVhdGVFbGVtZW50IiwiZGF0YXNldCIsInNyY3NldCIsImFwcGVuZENoaWxkIiwib25DbGlja1JlbmRlclNsaWRlcyIsInNsaWRlciIsImlubmVySFRNTCIsImkiLCJ1cGRhdGUiLCJzbGlkZVRvIiwiZm9yRWFjaCIsImdhbGxlcnlUb2dnbGUiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVUsS0FDVkMsT0FBUyxJQUNUQyxjQUFnQixHQUNoQkMsWUFBYyxHQUNkQyxRQUFVQyxTQUFTQyxjQUFjLHFCQUNqQ0MsWUFBY0YsU0FBU0MsY0FBYyxpQkFDckNFLE1BQVFILFNBQVNDLGNBQWMsVUFDL0JHLGFBQWVKLFNBQVNDLGNBQWMsa0JBQ3RDSSxZQUFjTCxTQUFTQyxjQUFjLHlCQUNyQ0ssYUFBZU4sU0FBU0MsY0FBYyxtQkFDdENNLFdBQWFQLFNBQVNDLGNBQWMsZ0JBQ3BDTyxXQUFhUixTQUFTQyxjQUFjLHdCQUNwQ1EsUUFBVVQsU0FBU0MsY0FBYyxvQkFDakNTLGNBQWdCVixTQUFTVyxpQkFBaUIsa0JBQzFDQyxXQUFhWixTQUFTVyxpQkFBaUIsZ0JBQ3ZDRSxZQUFjYixTQUFTQyxjQUFjLGlCQUNyQ2EsZ0JBQWtCZCxTQUFTQyxjQUFjLDRCQUN6Q2MsUUFBVUMsT0FBT0MsV0FBVyx1QkFDNUJDLFVBQVlsQixTQUFTQyxjQUFjLFNBQ3pDLElBQUlrQixjQUFnQm5CLFNBQVNDLGNBQWMsMEJBQ3ZDbUIsS0FBTyxLQUNUQyxLQUFPLEtBQ0xDLEtBQU8sRUFJWCxNQUFNQyxXQUFhLFNBQVVDLEVBQUtDLEdBdkJkLEtBd0JkRCxFQUFJRSxTQUNORCxLQU1FRSxVQUFZLENBQUNDLEVBQUlDLEtBQ3JCRCxFQUFHRSxVQUFVQyxJQUFJLGVBQ2pCSCxFQUFHSSxhQUFhLGNBQWMsR0FDOUJKLEVBQUdLLGdCQUFnQixlQUNmN0IsZUFDRkEsYUFBYThCLE1BQU1DLFFBQVUsU0FFL0JDLHNCQUNBQyxhQUFhUixRQUFRQSxJQUdqQlMsV0FBYSxDQUFDVixFQUFJQyxL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QVVDLElBQUksc0JBQzFCNEcsRUFBWTdHLFVBQVVDLElBQUksZ0JBRXRCMkcsRUFwWkssS0FxWlBSLEVBQVMsa0NBQWtDdkQscURBQXlEQSx1QkFFcEd3RCxFQUFNLGtDQUFrQ3hELGdCQUV4QzZELEVBQVlLLFFBQVFDLE9BQVNaLEVBQzdCTyxFQUFTSSxRQUFRVixJQUFNQSxFQUN2QlEsRUFBWUksWUFBWVYsR0FFeEJQLEVBQVlpQixZQUFZSixLQUV4QlQsRUFBUyxrQ0FBa0N2RCxxREFBeURBLHVCQUVwR3dELEVBQU0sa0NBQWtDeEQsZ0JBRXhDNkQsRUFBWUssUUFBUUMsT0FBU1osRUFDN0JPLEVBQVNJLFFBQVFWLElBQU1BLEVBQ3ZCUSxFQUFZSSxZQUFZVixHQUV4QlAsRUFBWWlCLFlBQVlKLEtBTXRCSyxFQUFzQixDQUFDckUsRUFBT3NFLEtBQ1RuQixFQUFZb0IsVUFBWSxHQUlqRCxJQUFLLElBQUlDLEVBQUksRUFBR0EsR0FBS3pJLGNBQWNrRSxPQUFRdUUsSUFDekNmLEVBQWFlLEdBR2ZGLEVBQU9HLFNBQ1BILEVBQU9JLFFBQVExRSxJQUtqQm9ELEVBQU91QixRQUFRLENBQUNDLEVBQWU1RSxLQUM3QjRFLEVBQWMxRyxpQkFBaUIsUUFBUyxLQUN0Q21HLEVBQW9CckUsRUFBT2tELGVBQzNCbEcsVUFBVXhCLE1BQU9VLGFBRWpCMEQsZUFDRSxtQkFDQSxtQkFDQXNELGNBQ0FBLGNBQWNMLFVBQ2Q5RyxjQUFja0UsUUFHaEJwQixXQUlKMUMsZ0JBQWdCK0IsaUJBQWlCLFFBQVMsSUFBTVAsV0FBV25DLE1BQU9hLFNBQ2xFWixhQUFheUMsaUJBQWlCLFFBQVMsSUFBTVAsV0FBV25DLE1BQU9hLFNBRS9ENkcsY0FBY2IsR0FBRyxjQUFlLEtBQzlCekMsZUFDRSxtQkFDQSxtQkFDQXNELGNBQ0FBLGNBQWNMLFVBQ2Q5RyxjQUFja0UiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBERVNLVE9QID0gMTE0MDtcbmNvbnN0IFRBQkxFVCA9IDc2NztcbmNvbnN0IEVOVEVSX0tFWUNPREUgPSAxMztcbmNvbnN0IEVTQ19LRVlDT0RFID0gMjc7XG5jb25zdCBtZW51QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wYWdlLWhlYWRlcl9fYnRuXCIpO1xuY29uc3QgbWVudU92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnUtb3ZlcmxheVwiKTtcbmNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbFwiKTtcbmNvbnN0IG1vZGFsT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtb3ZlcmxheVwiKTtcbmNvbnN0IGNvbnRhY3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250YWN0LWZvcm1fX2ZpZWxkc1wiKTtcbmNvbnN0IHNlcnZpY2VzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VydmljZXNfX2xpc3RcIik7XG5jb25zdCBjYWxsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYWxsLWJ1dHRvblwiKTtcbmNvbnN0IG1vZGFsQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhY3QtZm9ybV9fY2xvc2VcIik7XG5jb25zdCBpbnRyb0JnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbnRyb19fYmctaW1hZ2VcIik7XG5jb25zdCBnYWxsZXJ5SW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5nYWxsZXJ5X19pdGVtXCIpO1xuY29uc3QgY2FyZFNsaWRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2FyZF9fc2xpZGVcIik7XG5jb25zdCBtb2RhbFNsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtc2xpZGVyXCIpO1xuY29uc3QgZ2FsbGVyeUNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1zbGlkZXJfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGRlc2t0b3AgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtaW4td2lkdGg6IDExNDBweClcIik7XG5jb25zdCBtc25yeUdyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRcIik7XG5sZXQgc2xpZGVUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtc2xpZGVyLXRlbXBsYXRlXCIpO1xubGV0IHdpblggPSBudWxsLFxuICB3aW5ZID0gbnVsbDtcbmxldCBzdGVwID0gMTtcblxuLy8gKiDQpNGD0L3QutGG0LjRjyDQvtCx0YDQsNCx0L7RgtC60Lgg0L3QsNC20LDRgtC40Y8gZXNjXG5cbmNvbnN0IG9uRXNjRXZlbnQgPSBmdW5jdGlvbiAoZXZ0LCBhY3Rpb24pIHtcbiAgaWYgKGV2dC5rZXlDb2RlID09PSBFU0NfS0VZQ09ERSkge1xuICAgIGFjdGlvbigpO1xuICB9XG59O1xuXG4vLyAhINCk0YPQvdC60YbQuNGPINC+0YLQutGA0YvRgtC40Y8g0LzQvtC00LDQu9GM0L3QvtCz0L4g0L7QutC90LBcblxuY29uc3Qgb3Blbk1vZGFsID0gKGVsLCBjYXB0dXJlKSA9PiB7XG4gIGVsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbC0tb3BlblwiKTtcbiAgZWwuc2V0QXR0cmlidXRlKFwiYXJpYS1tb2RhbFwiLCB0cnVlKTtcbiAgZWwucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gIGlmIChtb2RhbE92ZXJsYXkpIHtcbiAgICBtb2RhbE92ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgfVxuICBkaXNhYmxlV2luZG93U2Nyb2xsKCk7XG4gIGZvY3VzTWFuYWdlci5jYXB0dXJlKGNhcHR1cmUpO1xufTtcblxuY29uc3QgY2xvc2VNb2RhbCA9IChlbCwgY2FwdHVyZSkgPT4ge1xuICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWwtLW9wZW5cIikpIHtcbiAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWwtLW9wZW5cIik7XG4gICAgZWwucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1tb2RhbFwiKTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCB0cnVlKTtcbiAgICBlbmFibGVXaW5kb3dTY3JvbGwoKTtcbiAgICBmb2N1c01hbmFnZXIucmVsZWFzZShjYXB0dXJlKTtcbiAgfVxuXG4gIGlmIChtb2RhbE92ZXJsYXkpIHtcbiAgICBtb2RhbE92ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICB9XG59O1xuXG4vLyAhINCk0YPQvdC60YbQuNGPINCx0LvQvtC60LjRgNC+0LLQutC4INGB0LrRgNC+0LvQu9CwXG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKHdpblggIT09IG51bGwgJiYgd2luWSAhPT0gbnVsbCkge1xuICAgIHdpbmRvdy5zY3JvbGxUbyh3aW5YLCB3aW5ZKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGRpc2FibGVXaW5kb3dTY3JvbGwoKSB7XG4gIHdpblggPSB3aW5kb3cuc2Nyb2xsWDtcbiAgd2luWSA9IHdpbmRvdy5zY3JvbGxZO1xufVxuXG5mdW5jdGlvbiBlbmFibGVXaW5kb3dTY3JvbGwoKSB7XG4gIHdpblggPSBudWxsO1xuICB3aW5ZID0gbnVsbDtcbn1cblxuLy8gISDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyBNYXNvbnJ5INC4IFlhbGxcblxuaWYgKG1zbnJ5R3JpZCkge1xuICBjb25zdCBncmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkXCIpO1xuXG4gIGxldCBtc25yeSA9IG5ldyBNYXNvbnJ5KGdyaWQsIHtcbiAgICBjb2x1bW5XaWR0aDogXCIuZ3JpZC1zaXplclwiLFxuICAgIGl0ZW1TZWxlY3RvcjogXCIuZ3JpZC1pdGVtXCIsXG4gICAgcGVyY2VudFBvc2l0aW9uOiB0cnVlLFxuICAgIHRyYW5zaXRpb25EdXJhdGlvbjogXCIwLjJzXCJcbiAgfSk7XG5cbiAgZnVuY3Rpb24gZG9NYXNvbnJ5KCkge1xuICAgIG1zbnJ5LmxheW91dCgpO1xuICB9O1xuXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+XG4gICAgeWFsbCh7XG4gICAgICBldmVudHM6IHtcbiAgICAgICAgbG9hZDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJnYWxsZXJ5X19pbWFnZS0tdW5sb2FkZWRcIikpIHtcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKFwiZ2FsbGVyeV9faW1hZ2UtLXVubG9hZGVkXCIpO1xuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZG9NYXNvbnJ5LCAzMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgIH1cbiAgICB9KVxuICApO1xufSBlbHNlIHtcblxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PlxuICAgIHlhbGwoe1xuICAgICAgb2JzZXJ2ZUNoYW5nZXM6IHRydWUsXG4gICAgICBub1BvbHlmaWxsOiB0cnVlLFxuICAgIH0pXG4gICk7XG59XG5cbi8vICEg0J/QtdGA0LXQutC70Y7Rh9C10L3QuNC1INC80LXQvdGOXG5cbmlmIChtZW51QnRuICYmIG1lbnVPdmVybGF5KSB7XG4gIGNvbnN0IG9uQ2xpY2tNZW51VG9nZ2xlID0gKCkgPT4ge1xuICAgIG1lbnVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInBhZ2UtaGVhZGVyX19idG4tLWNsb3NlXCIpO1xuICAgIG1lbnVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInBhZ2UtaGVhZGVyX19idG4tLW9wZW5cIik7XG4gICAgbWVudU92ZXJsYXkuY2xhc3NMaXN0LnRvZ2dsZShcIm1lbnUtb3ZlcmxheS0tc2hvd25cIik7XG4gICAgaWYgKG1lbnVPdmVybGF5LmNsYXNzTGlzdC5jb250YWlucyhcIm1lbnUtb3ZlcmxheS0tc2hvd25cIikpIHtcbiAgICAgIGRpc2FibGVXaW5kb3dTY3JvbGwoKTtcbiAgICAgIGZvY3VzTWFuYWdlci5jYXB0dXJlKG1lbnVPdmVybGF5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgZW5hYmxlV2luZG93U2Nyb2xsKCk7XG4gICAgICBmb2N1c01hbmFnZXIucmVsZWFzZShtZW51T3ZlcmxheSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGNsb3NlTWVudSA9ICgpID0+IHtcbiAgICBpZiAobWVudU92ZXJsYXkuY2xhc3NMaXN0LmNvbnRhaW5zKFwibWVudS1vdmVybGF5LS1zaG93blwiKSkge1xuICAgICAgbWVudU92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShcIm1lbnUtb3ZlcmxheS0tc2hvd25cIik7XG4gICAgICBtZW51QnRuLmNsYXNzTGlzdC50b2dnbGUoXCJwYWdlLWhlYWRlcl9fYnRuLS1jbG9zZVwiKTtcbiAgICAgIG1lbnVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInBhZ2UtaGVhZGVyX19idG4tLW9wZW5cIik7XG4gICAgfVxuICB9O1xuXG4gIG1lbnVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQ2xpY2tNZW51VG9nZ2xlKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldnQpID0+IHtcbiAgICBvbkVzY0V2ZW50KGV2dCwgY2xvc2VNZW51KTtcbiAgfSk7XG59XG5cbi8vICEgSW50cm8gYmcgcGFyYWxsYXhcbmlmIChpbnRyb0JnICE9PSBudWxsKSB7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsICgpID0+IHtcbiAgICBsZXQgdmFsdWUgPSB3aW5kb3cuc2Nyb2xsWTtcblxuICAgIGludHJvQmcuc3R5bGUudG9wID0gdmFsdWUgKiAwLjUgKyBcInB4XCI7XG4gIH0pO1xufVxuXG4vLyAhINCS0YvQt9C+0LIg0Lgg0LfQsNC60YDRi9GC0LjQtSDQvNC+0LTQsNC70YzQvdC+0LPQviDQvtC60L3QsFxuaWYgKGNhbGxCdXR0b24gJiYgbW9kYWwgJiYgbW9kYWxDbG9zZSAmJiBtb2RhbE92ZXJsYXkpIHtcbiAgLy8g0J7QsdGA0LDQsdC+0YLRh9C40LrQuCDQtNC10LnRgdGC0LLQuNC5INC80L7QtNCw0LvRjNC90L7Qs9C+INC+0LrQvdCwXG5cbiAgY2FsbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gb3Blbk1vZGFsKG1vZGFsLCBjb250YWN0Rm9ybSkpO1xuXG4gIG1vZGFsQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwsIGNhbGxCdXR0b24pKTtcblxuICBtb2RhbE92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwsIGNhbGxCdXR0b24pKTtcblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGV2dCkgPT4ge1xuICAgIG9uRXNjRXZlbnQoZXZ0LCBjbG9zZU1vZGFsKG1vZGFsLCBjYWxsQnV0dG9uKSk7XG4gIH0pO1xufVxuXG4vLyAhINCk0YPQvdC60YbQuNGPINC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0LrQvdC+0L/QutC4INGB0LvQsNC50LTQtdGA0LBcblxuY29uc3QgbWFuYWdlQ29udHJvbHMgPSAoXG4gIHByZXZDc3NDbGFzcyxcbiAgbmV4dENzc0NsYXNzLFxuICBjdXJyZW50U2xpZGVyLFxuICBpbmRleCxcbiAgbGVuZ3RoXG4pID0+IHtcbiAgY29uc3QgcHJldkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJldkNzc0NsYXNzKTtcbiAgY29uc3QgbmV4dEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmV4dENzc0NsYXNzKTtcblxuICBpZiAocHJldkJ0biAmJiBjdXJyZW50U2xpZGVyICYmIGluZGV4ID4gMCkge1xuICAgIHByZXZCdG4uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICBuZXh0QnRuLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gIH1cblxuICBpZiAocHJldkJ0biAmJiBjdXJyZW50U2xpZGVyICYmIGluZGV4ID09PSAwKSB7XG4gICAgcHJldkJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgbmV4dEJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICB9XG5cbiAgaWYgKHByZXZCdG4gJiYgY3VycmVudFNsaWRlciAmJiBpbmRleCA9PT0gbGVuZ3RoIC0gMSkge1xuICAgIG5leHRCdG4uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICB9XG59O1xuXG4vLyAhINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINGB0LvQsNC50LTQtdGA0LAg0LTQu9GPINCx0LvQvtC60LAg4oCY0KPRgdC70YPQs9C44oCYXG5cbmxldCBzZXJ2aWNlc1NsaWRlcjtcblxuY29uc3QgYnJlYWtwb2ludENoZWNrZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGlmIChkZXNrdG9wLm1hdGNoZXMgPT09IHRydWUpIHtcbiAgICBpZiAoc2VydmljZXNTbGlkZXIgIT09IHVuZGVmaW5lZCAmJiBzZXJ2aWNlc0xpc3QpXG4gICAgICBzZXJ2aWNlc1NsaWRlci5kZXN0cm95KHRydWUsIHRydWUpO1xuXG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGRlc2t0b3AubWF0Y2hlcyA9PT0gZmFsc2UpIHtcbiAgICByZXR1cm4gZW5hYmxlU3dpcGVyKCk7XG4gIH1cbn07XG5cbmNvbnN0IGVuYWJsZVN3aXBlciA9IGZ1bmN0aW9uICgpIHtcbiAgc2VydmljZXNTbGlkZXIgPSBuZXcgU3dpcGVyKFwiLnN3aXBlcjFcIiwge1xuICAgIGExMXk6IHRydWUsXG4gICAgcGFnaW5hdGlvbkJ1bGxldE1lc3NhZ2U6IFwi0J/QtdGA0LXQudGC0Lgg0Log0YHQu9Cw0LnQtNGDIHt7aW5kZXh9fVwiLFxuXG4gICAgYnJlYWtwb2ludHM6IHtcbiAgICAgIDI1MDoge1xuICAgICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgICAgZWw6IFwiLnN3aXBlci1wYWdpbmF0aW9uXCIsXG4gICAgICAgICAgY2xpY2thYmxlOiB0cnVlLFxuICAgICAgICAgIHJlbmRlckJ1bGxldDogZnVuY3Rpb24gKGluZGV4LCBjbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiJyArXG4gICAgICAgICAgICAgIGNsYXNzTmFtZSArXG4gICAgICAgICAgICAgICdcIiBhcmlhLWxhYmVsPSBcIicgK1xuICAgICAgICAgICAgICBcItCf0LXRgNC10LnRgtC4INC6INGB0LvQsNC50LTRgyBcIiArXG4gICAgICAgICAgICAgIGluZGV4ICtcbiAgICAgICAgICAgICAgJ1wiPicgK1xuICAgICAgICAgICAgICBcItCf0LXRgNC10LnRgtC4INC6INGB0LvQsNC50LTRgyBcIiArXG4gICAgICAgICAgICAgIGluZGV4ICtcbiAgICAgICAgICAgICAgXCI8L2J1dHRvbj5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgICAgIHNsaWRlc1Blckdyb3VwOiAxLFxuICAgICAgICBzcGFjZUJldHdlZW46IDI4LFxuICAgICAgICBpbml0aWFsU2xpZGU6IDAsXG4gICAgICAgIHNldFdyYXBwZXJTaXplOiB0cnVlLFxuICAgICAgICBncmFiQ3Vyc29yOiB0cnVlLFxuICAgICAgICB1cGRhdGVPbldpbmRvd1Jlc2l6ZTogdHJ1ZSxcbiAgICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXG4gICAgICAgIGNlbnRlcmVkU2xpZGVzQm91bmRzOiB0cnVlLFxuICAgICAgfSxcblxuICAgICAgNzY4OiB7XG4gICAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgICBlbDogXCIuc3dpcGVyLXBhZ2luYXRpb25cIixcbiAgICAgICAgICBjbGlja2FibGU6IHRydWUsXG4gICAgICAgICAgcmVuZGVyQnVsbGV0OiBmdW5jdGlvbiAoaW5kZXgsIGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCInICtcbiAgICAgICAgICAgICAgY2xhc3NOYW1lICtcbiAgICAgICAgICAgICAgJ1wiIGFyaWEtbGFiZWw9IFwiJyArXG4gICAgICAgICAgICAgIFwi0J/QtdGA0LXQudGC0Lgg0Log0YHQu9Cw0LnQtNGDIFwiICtcbiAgICAgICAgICAgICAgaW5kZXggK1xuICAgICAgICAgICAgICAnXCI+JyArXG4gICAgICAgICAgICAgIFwi0J/QtdGA0LXQudGC0Lgg0Log0YHQu9Cw0LnQtNGDIFwiICtcbiAgICAgICAgICAgICAgaW5kZXggK1xuICAgICAgICAgICAgICBcIjwvYnV0dG9uPlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2xpZGVzUGVyVmlldzogMixcbiAgICAgICAgc2xpZGVzUGVyR3JvdXA6IDIsXG4gICAgICAgIGluaXRpYWxTbGlkZTogMCxcbiAgICAgICAgc2V0V3JhcHBlclNpemU6IHRydWUsXG4gICAgICAgIGdyYWJDdXJzb3I6IHRydWUsXG4gICAgICAgIHVwZGF0ZU9uV2luZG93UmVzaXplOiB0cnVlLFxuICAgICAgICBjc3NXaWR0aEFuZEhlaWdodDogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG59O1xuXG5kZXNrdG9wLmFkZExpc3RlbmVyKGJyZWFrcG9pbnRDaGVja2VyKTtcblxuYnJlYWtwb2ludENoZWNrZXIoKTtcblxuLy8gISDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyDRgdC70LDQudC00LXRgNCwINC60LDRgNGC0L7Rh9C10Log0YPRgdC70YPQs1xuXG5sZXQgY2FyZHNTbGlkZXIgPSBuZXcgU3dpcGVyKFwiLnN3aXBlcjJcIiwge1xuICBzbGlkZXNQZXJWaWV3OiA0LFxuICBzbGlkZXNQZXJHcm91cDogNCxcbiAgaW5pdGlhbFNsaWRlOiAwLFxuICBzcGFjZUJldHdlZW46IDIwLFxuICBhMTF5OiB0cnVlLFxuICBwYWdpbmF0aW9uQnVsbGV0TWVzc2FnZTogXCLQn9C10YDQtdC50YLQuCDQuiDRgdC70LDQudC00YMge3tpbmRleH19XCIsXG4gIGtleWJvYXJkQ29udHJvbDogdHJ1ZSxcbiAgZ3JhYkN1cnNvcjogdHJ1ZSxcbiAgdXBkYXRlT25XaW5kb3dSZXNpemU6IHRydWUsXG4gIG5hdmlnYXRpb246IHtcbiAgICBuZXh0RWw6IFwiLmNhcmRfX2NvbnRyb2wtLW5leHRcIixcbiAgICBwcmV2RWw6IFwiLmNhcmRfX2NvbnRyb2wtLXByZXZcIixcbiAgfSxcbiAgLy8gY3NzV2lkdGhBbmRIZWlnaHQ6IHRydWUsXG5cbiAgYnJlYWtwb2ludHM6IHtcbiAgICAyNTA6IHtcbiAgICAgIHNwYWNlQmV0d2VlbjogMTUsXG4gICAgICBpbml0aWFsU2xpZGU6IDAsXG4gICAgICBrZXlib2FyZENvbnRyb2w6IHRydWUsXG4gICAgICBncmFiQ3Vyc29yOiB0cnVlLFxuICAgICAgdXBkYXRlT25XaW5kb3dSZXNpemU6IHRydWUsXG4gICAgfSxcblxuICAgIDM4NDoge1xuICAgICAgaW5pdGlhbFNsaWRlOiAwLFxuICAgICAgb246IHtcbiAgICAgICAgYmVmb3JlUmVzaXplKCkge1xuICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSAzODQpIHtcbiAgICAgICAgICAgIGNhcmRzU2xpZGVyLnNsaWRlcy5jc3MoXCJ3aWR0aFwiLCBcIlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG5cbiAgICA3Njg6IHtcbiAgICAgIHNsaWRlc1BlclZpZXc6IDQsXG4gICAgICBzbGlkZXNQZXJHcm91cDogNCxcbiAgICAgIGluaXRpYWxTbGlkZTogMCxcbiAgICAgIHNwYWNlQmV0d2VlbjogMjMsXG4gICAgICBzZXRXcmFwcGVyU2l6ZTogdHJ1ZSxcbiAgICAgIGtleWJvYXJkQ29udHJvbDogdHJ1ZSxcbiAgICAgIGdyYWJDdXJzb3I6IHRydWUsXG4gICAgICB1cGRhdGVPbldpbmRvd1Jlc2l6ZTogdHJ1ZSxcbiAgICAgIGNzc1dpZHRoQW5kSGVpZ2h0OiB0cnVlLFxuICAgIH0sXG5cbiAgICAxMTQxOiB7XG4gICAgICBzcGFjZUJldHdlZW46IDksXG4gICAgfSxcblxuICAgIDEzMDA6IHtcbiAgICAgIHNwYWNlQmV0d2VlbjogMTIsXG4gICAgfSxcblxuICAgIDE1MDA6IHtcbiAgICAgIHNwYWNlQmV0d2VlbjogMTYsXG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vLyAqINCe0LHRgNCw0LHQvtGC0YfQuNC6INGB0LzQtdC90Ysg0YHQu9Cw0LnQtNC+0LJcblxuY2FyZHNTbGlkZXIub24oXCJzbGlkZUNoYW5nZVwiLCAoKSA9PlxuICBtYW5hZ2VDb250cm9scyhcbiAgICBcIi5jYXJkX19jb250cm9sLS1wcmV2XCIsXG4gICAgXCIuY2FyZF9fY29udHJvbC0tbmV4dFwiLFxuICAgIGNhcmRzU2xpZGVyLFxuICAgIGNhcmRzU2xpZGVyLnJlYWxJbmRleCxcbiAgICBjYXJkU2xpZGVzLmxlbmd0aFxuICApXG4pO1xuXG4vLyAhINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINC80L7QtNCw0LvRjNC90L7Qs9C+INGB0LvQsNC50LTQtdGA0LBcblxubGV0IG1vZGFsU2xpZGVyT3B0aW9ucyA9IHtcbiAgc2xpZGVzUGVyVmlldzogMSxcbiAgc2xpZGVzUGVyR3JvdXA6IDEsXG4gIGExMXk6IHRydWUsXG4gIGluaXRpYWxTbGlkZTogMCxcbiAgb2JzZXJ2ZXI6IHRydWUsXG4gIHVwZGF0ZU9uV2luZG93UmVzaXplOiB0cnVlLFxuICBuYXZpZ2F0aW9uOiB7XG4gICAgbmV4dEVsOiBcIi5tb2RhbC1idG4tLW5leHRcIixcbiAgICBwcmV2RWw6IFwiLm1vZGFsLWJ0bi0tcHJldlwiLFxuICB9LFxuICBmYWRlRWZmZWN0OiB7XG4gICAgY3Jvc3NGYWRlOiB0cnVlLFxuICB9LFxufTtcblxuY29uc3QgZ2FsbGVyeVNsaWRlciA9IG5ldyBTd2lwZXIoXCIuc3dpcGVyM1wiLCBtb2RhbFNsaWRlck9wdGlvbnMpO1xuXG4vLyAhINCU0L7QsdCw0LLQu9C10L3QuNC1INGB0LvQsNC50LTQvtCyXG5cbmlmIChtb2RhbCAmJiBnYWxsZXJ5SW1hZ2VzICYmIG1vZGFsU2xpZGVyKSB7XG4gIGxldCBnYWxsZXJ5TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3dpcGVyLXdyYXBwZXJcIik7XG5cbiAgaWYgKHNsaWRlVGVtcGxhdGUpIHtcbiAgICBjb25zdCBpbWFnZXMgPSBBcnJheS5mcm9tKGdhbGxlcnlJbWFnZXMpO1xuICAgIGxldCBzcmNTZXQ7XG4gICAgbGV0IHNyYztcblxuICAgIC8vICog0KTRg9C90LrRhtC40Y8g0YHQvtC30LTQsNC90LjRjyDRgdC70LDQudC00LBcblxuICAgIGNvbnN0IGdldExhenlTbGlkZSA9IChpbmRleCkgPT4ge1xuICAgICAgbGV0IHNsaWRlRWxlbWVudCA9IHNsaWRlVGVtcGxhdGUuY29udGVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1zbGlkZXJfX3BpY3R1cmVcIilcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIGxldCBzbGlkZVNvdXJjZSA9IHNsaWRlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwic291cmNlXCIpO1xuICAgICAgbGV0IHNsaWRlSW1nID0gc2xpZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbWdcIik7XG4gICAgICBsZXQgdmlld1BvcnQgPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgIGxldCBnYWxsZXJ5SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcblxuICAgICAgZ2FsbGVyeUl0ZW0uY2xhc3NMaXN0LmFkZChcIm1vZGFsLXNsaWRlcl9faXRlbVwiKTtcbiAgICAgIGdhbGxlcnlJdGVtLmNsYXNzTGlzdC5hZGQoXCJzd2lwZXItc2xpZGVcIik7XG5cbiAgICAgIGlmICh2aWV3UG9ydCA+IFRBQkxFVCkge1xuICAgICAgICBzcmNTZXQgPSBgaW1nL2dhbGxlcnkvdGFibGV0L2dhbGxlcnktaW1nLSR7aW5kZXh9LS10YWJsZXQud2VicCAxeCwgaW1nL2dhbGxlcnkvdGFibGV0L2dhbGxlcnktaW1nLSR7aW5kZXh9LS10YWJsZXRAMngud2VicCAyeGA7XG5cbiAgICAgICAgc3JjID0gYGltZy9nYWxsZXJ5L3RhYmxldC9nYWxsZXJ5LWltZy0ke2luZGV4fS0tdGFibGV0LmpwZ2A7XG5cbiAgICAgICAgc2xpZGVTb3VyY2UuZGF0YXNldC5zcmNzZXQgPSBzcmNTZXQ7XG4gICAgICAgIHNsaWRlSW1nLmRhdGFzZXQuc3JjID0gc3JjO1xuICAgICAgICBnYWxsZXJ5SXRlbS5hcHBlbmRDaGlsZChzbGlkZUVsZW1lbnQpO1xuXG4gICAgICAgIGdhbGxlcnlMaXN0LmFwcGVuZENoaWxkKGdhbGxlcnlJdGVtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNyY1NldCA9IGBpbWcvZ2FsbGVyeS9tb2JpbGUvZ2FsbGVyeS1pbWctJHtpbmRleH0tLW1vYmlsZS53ZWJwIDF4LCBpbWcvZ2FsbGVyeS9tb2JpbGUvZ2FsbGVyeS1pbWctJHtpbmRleH0tLW1vYmlsZUAyeC53ZWJwIDJ4YDtcblxuICAgICAgICBzcmMgPSBgaW1nL2dhbGxlcnkvbW9iaWxlL2dhbGxlcnktaW1nLSR7aW5kZXh9LS1tb2JpbGUuanBnYDtcblxuICAgICAgICBzbGlkZVNvdXJjZS5kYXRhc2V0LnNyY3NldCA9IHNyY1NldDtcbiAgICAgICAgc2xpZGVJbWcuZGF0YXNldC5zcmMgPSBzcmM7XG4gICAgICAgIGdhbGxlcnlJdGVtLmFwcGVuZENoaWxkKHNsaWRlRWxlbWVudCk7XG5cbiAgICAgICAgZ2FsbGVyeUxpc3QuYXBwZW5kQ2hpbGQoZ2FsbGVyeUl0ZW0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyAqINCk0YPQvdC60YbQuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC6INGB0LzQtdC90Ysg0YHQu9Cw0LnQtNC+0LJcblxuICAgIGNvbnN0IG9uQ2xpY2tSZW5kZXJTbGlkZXMgPSAoaW5kZXgsIHNsaWRlcikgPT4ge1xuICAgICAgbGV0IGNsZWFyU2xpZGVzID0gKCkgPT4gKGdhbGxlcnlMaXN0LmlubmVySFRNTCA9IFwiXCIpO1xuXG4gICAgICBjbGVhclNsaWRlcygpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBnYWxsZXJ5SW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdldExhenlTbGlkZShpKTtcbiAgICAgIH1cblxuICAgICAgc2xpZGVyLnVwZGF0ZSgpO1xuICAgICAgc2xpZGVyLnNsaWRlVG8oaW5kZXgpO1xuICAgIH07XG5cbiAgICAvLyAqINCe0LHRgNCw0LHQvtGC0LrQsCDQtNC10LnRgdGC0LLQuNC5INC/0L4g0L3QsNC20LDRgtC40Y4g0L3QsCDQuNC30L7QsdGA0LDQttC10L3QuNGPXG5cbiAgICBpbWFnZXMuZm9yRWFjaCgoZ2FsbGVyeVRvZ2dsZSwgaW5kZXgpID0+IHtcbiAgICAgIGdhbGxlcnlUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgb25DbGlja1JlbmRlclNsaWRlcyhpbmRleCwgZ2FsbGVyeVNsaWRlcik7XG4gICAgICAgIG9wZW5Nb2RhbChtb2RhbCwgbW9kYWxTbGlkZXIpO1xuXG4gICAgICAgIG1hbmFnZUNvbnRyb2xzKFxuICAgICAgICAgIFwiLm1vZGFsLWJ0bi0tcHJldlwiLFxuICAgICAgICAgIFwiLm1vZGFsLWJ0bi0tbmV4dFwiLFxuICAgICAgICAgIGdhbGxlcnlTbGlkZXIsXG4gICAgICAgICAgZ2FsbGVyeVNsaWRlci5yZWFsSW5kZXgsXG4gICAgICAgICAgZ2FsbGVyeUltYWdlcy5sZW5ndGhcbiAgICAgICAgKTtcblxuICAgICAgICB5YWxsKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGdhbGxlcnlDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChtb2RhbCwgd2luZG93KSk7XG4gICAgbW9kYWxPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKG1vZGFsLCB3aW5kb3cpKTtcblxuICAgIGdhbGxlcnlTbGlkZXIub24oXCJzbGlkZUNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICBtYW5hZ2VDb250cm9scyhcbiAgICAgICAgXCIubW9kYWwtYnRuLS1wcmV2XCIsXG4gICAgICAgIFwiLm1vZGFsLWJ0bi0tbmV4dFwiLFxuICAgICAgICBnYWxsZXJ5U2xpZGVyLFxuICAgICAgICBnYWxsZXJ5U2xpZGVyLnJlYWxJbmRleCxcbiAgICAgICAgZ2FsbGVyeUltYWdlcy5sZW5ndGhcbiAgICAgICk7XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==
