const DESKTOP=1140,TABLET=767,ENTER_KEYCODE=13,ESC_KEYCODE=27,menuBtn=document.querySelector(".page-header__btn"),menuOverlay=document.querySelector(".menu-overlay"),modal=document.querySelector(".modal"),modalOverlay=document.querySelector(".modal-overlay"),contactForm=document.querySelector(".contact-form__fields"),servicesList=document.querySelector(".services__list"),callButton=document.querySelector("#call-button"),modalClose=document.querySelector(".contact-form__close"),introBg=document.querySelector(".intro__bg-image"),galleryImages=document.querySelectorAll(".gallery__item"),cardSlides=document.querySelectorAll(".card__slide"),modalSlider=document.querySelector(".modal-slider"),galleryCloseBtn=document.querySelector(".modal-slider__close-btn"),desktop=window.matchMedia("(min-width: 1140px)"),msnryGrid=document.querySelector(".grid");let slideTemplate=document.querySelector("#modal-slider-template"),winX=null,winY=null,step=1;const onEscEvent=function(e,l){27===e.keyCode&&l()},openModal=(e,l)=>{e.classList.add("modal--open"),e.setAttribute("aria-modal",!0),e.removeAttribute("aria-hidden"),modalOverlay&&(modalOverlay.style.display="block"),disableWindowScroll(),focusManager.capture(l)},closeModal=(e,l)=>{e.classList.contains("modal--open")&&(e.classList.remove("modal--open"),e.removeAttribute("aria-modal"),e.setAttribute("aria-hidden",!0),enableWindowScroll(),focusManager.release(l)),modalOverlay&&(modalOverlay.style.display="none")};function disableWindowScroll(){winX=window.scrollX,winY=window.scrollY}function enableWindowScroll(){winX=null,winY=null}if(window.addEventListener("scroll",(function(){null!==winX&&null!==winY&&window.scrollTo(winX,winY)})),msnryGrid){const e=document.querySelector(".grid");let l=new Masonry(e,{columnWidth:".grid-sizer",itemSelector:".grid-item",percentPosition:!0,transitionDuration:"0.2s"});function doMasonry(){l.layout()}document.addEventListener("DOMContentLoaded",()=>yall({events:{load:function(e){e.target.classList.contains("gallery__image--unloaded")&&(e.target.classList.remove("gallery__image--unloaded"),window.setTimeout(doMasonry,300),console.log(e.target.classList.contains("gallery__image--unloaded")))}},options:{once:!0}}))}else document.addEventListener("DOMContentLoaded",()=>yall({observeChanges:!0,noPolyfill:!0}));if(menuBtn&&menuOverlay){const e=()=>{menuBtn.classList.toggle("page-header__btn--close"),menuBtn.classList.toggle("page-header__btn--open"),menuOverlay.classList.toggle("menu-overlay--shown"),menuOverlay.classList.contains("menu-overlay--shown")?(disableWindowScroll(),focusManager.capture(menuOverlay)):(enableWindowScroll(),focusManager.release(menuOverlay))},l=()=>{menuOverlay.classList.contains("menu-overlay--shown")&&(menuOverlay.classList.remove("menu-overlay--shown"),menuBtn.classList.toggle("page-header__btn--close"),menuBtn.classList.toggle("page-header__btn--open"))};menuBtn.addEventListener("click",e),window.addEventListener("keydown",e=>{onEscEvent(e,l)})}null!==introBg&&window.addEventListener("scroll",()=>{let e=window.scrollY;introBg.style.top=.5*e+"px"}),callButton&&modal&&modalClose&&modalOverlay&&(callButton.addEventListener("click",()=>openModal(modal,contactForm)),modalClose.addEventListener("click",()=>closeModal(modal,callButton)),modalOverlay.addEventListener("click",()=>closeModal(modal,callButton)),window.addEventListener("keydown",e=>{onEscEvent(e,closeModal(modal,callButton))}));const manageControls=(e,l,n,t,a)=>{const o=document.querySelector(e),r=document.querySelector(l);o&&n&&t>0&&(o.style.display="block",r.style.display="block"),o&&n&&0===t&&(o.style.display="none",r.style.display="block"),o&&n&&t===a-1&&(r.style.display="none")};let servicesSlider;const breakpointChecker=function(){if(!0!==desktop.matches)return!1===desktop.matches?enableSwiper():void 0;void 0!==servicesSlider&&servicesList&&servicesSlider.destroy(!0,!0)},enableSwiper=function(){servicesSlider=new Swiper(".swiper1",{a11y:!0,paginationBulletMessage:"Перейти к слайду {{index}}",breakpoints:{250:{pagination:{el:".swiper-pagination",clickable:!0,renderBullet:function(e,l){return'<button class="'+l+'" aria-label= "Перейти к слайду '+e+'">Перейти к слайду '+e+"</button>"}},slidesPerView:1,slidesPerGroup:1,spaceBetween:28,initialSlide:0,setWrapperSize:!0,grabCursor:!0,updateOnWindowResize:!0,centeredSlides:!0,centeredSlidesBounds:!0},768:{pagination:{el:".swiper-pagination",clickable:!0,renderBullet:function(e,l){return'<button class="'+l+'" aria-label= "Перейти к слайду '+e+'">Перейти к слайду '+e+"</button>"}},slidesPerView:2,slidesPerGroup:2,initialSlide:0,setWrapperSize:!0,grabCursor:!0,updateOnWindowResize:!0,cssWidthAndHeight:!0}}})};desktop.addListener(breakpointChecker),breakpointChecker();let cardsSlider=new Swiper(".swiper2",{slidesPerView:4,slidesPerGroup:4,initialSlide:0,spaceBetween:20,a11y:!0,paginationBulletMessage:"Перейти к слайду {{index}}",keyboardControl:!0,grabCursor:!0,updateOnWindowResize:!0,navigation:{nextEl:".card__control--next",prevEl:".card__control--prev"},breakpoints:{250:{spaceBetween:15,initialSlide:0,keyboardControl:!0,grabCursor:!0,updateOnWindowResize:!0},384:{initialSlide:0,on:{beforeResize(){window.innerWidth>=384&&cardsSlider.slides.css("width","")}}},768:{slidesPerView:4,slidesPerGroup:4,initialSlide:0,spaceBetween:23,setWrapperSize:!0,keyboardControl:!0,grabCursor:!0,updateOnWindowResize:!0,cssWidthAndHeight:!0},1141:{spaceBetween:9},1300:{spaceBetween:12},1500:{spaceBetween:16}}});cardsSlider.on("slideChange",()=>manageControls(".card__control--prev",".card__control--next",cardsSlider,cardsSlider.realIndex,cardSlides.length));let modalSliderOptions={slidesPerView:1,slidesPerGroup:1,a11y:!0,initialSlide:0,observer:!0,updateOnWindowResize:!0,navigation:{nextEl:".modal-btn--next",prevEl:".modal-btn--prev"},fadeEffect:{crossFade:!0}};const gallerySlider=new Swiper(".swiper3",modalSliderOptions);if(modal&&galleryImages&&modalSlider){let e=document.querySelector(".swiper-wrapper");if(slideTemplate){const l=Array.from(galleryImages);let n,t;const a=l=>{let a=slideTemplate.content.querySelector(".modal-slider__picture").cloneNode(!0),o=a.querySelector("source"),r=a.querySelector("img"),i=window.innerWidth,d=document.createElement("li");d.classList.add("modal-slider__item"),d.classList.add("swiper-slide"),i>767?(n=`img/gallery/tablet/gallery-img-${l}--tablet.webp 1x, img/gallery/tablet/gallery-img-${l}--tablet@2x.webp 2x`,t=`img/gallery/tablet/gallery-img-${l}--tablet.jpg`,o.dataset.srcset=n,r.dataset.src=t,d.appendChild(a),e.appendChild(d)):(n=`img/gallery/mobile/gallery-img-${l}--mobile.webp 1x, img/gallery/mobile/gallery-img-${l}--mobile@2x.webp 2x`,t=`img/gallery/mobile/gallery-img-${l}--mobile.jpg`,o.dataset.srcset=n,r.dataset.src=t,d.appendChild(a),e.appendChild(d))},o=(l,n)=>{e.innerHTML="";for(let e=1;e<=galleryImages.length;e++)a(e);n.update(),n.slideTo(l)};l.forEach((e,l)=>{e.addEventListener("click",()=>{o(l,gallerySlider),openModal(modal,modalSlider),manageControls(".modal-btn--prev",".modal-btn--next",gallerySlider,gallerySlider.realIndex,galleryImages.length),yall()})}),galleryCloseBtn.addEventListener("click",()=>closeModal(modal,window)),modalOverlay.addEventListener("click",()=>closeModal(modal,window)),gallerySlider.on("slideChange",()=>{manageControls(".modal-btn--prev",".modal-btn--next",gallerySlider,gallerySlider.realIndex,galleryImages.length)})}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiREVTS1RPUCIsIlRBQkxFVCIsIkVOVEVSX0tFWUNPREUiLCJFU0NfS0VZQ09ERSIsIm1lbnVCdG4iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51T3ZlcmxheSIsIm1vZGFsIiwibW9kYWxPdmVybGF5IiwiY29udGFjdEZvcm0iLCJzZXJ2aWNlc0xpc3QiLCJjYWxsQnV0dG9uIiwibW9kYWxDbG9zZSIsImludHJvQmciLCJnYWxsZXJ5SW1hZ2VzIiwicXVlcnlTZWxlY3RvckFsbCIsImNhcmRTbGlkZXMiLCJtb2RhbFNsaWRlciIsImdhbGxlcnlDbG9zZUJ0biIsImRlc2t0b3AiLCJ3aW5kb3ciLCJtYXRjaE1lZGlhIiwibXNucnlHcmlkIiwic2xpZGVUZW1wbGF0ZSIsIndpblgiLCJ3aW5ZIiwic3RlcCIsIm9uRXNjRXZlbnQiLCJldnQiLCJhY3Rpb24iLCJrZXlDb2RlIiwib3Blbk1vZGFsIiwiZWwiLCJjYXB0dXJlIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwic3R5bGUiLCJkaXNwbGF5IiwiZGlzYWJsZVdpbmRvd1Njcm9sbCIsImZvY3VzTWFuYWdlciIsImNsb3NlTW9kYWwiLCJjb250YWlucyIsInJlbW92ZSIsImVuYWJsZVdpbmRvd1Njcm9sbCIsInJlbGVhc2UiLCJzY3JvbGxYIiwic2Nyb2xsWSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzY3JvbGxUbyIsImdyaWQiLCJtc25yeSIsIk1hc29ucnkiLCJjb2x1bW5XaWR0aCIsIml0ZW1TZWxlY3RvciIsInBlcmNlbnRQb3NpdGlvbiIsInRyYW5zaXRpb25EdXJhdGlvbiIsImRvTWFzb25yeSIsImxheW91dCIsInlhbGwiLCJldmVudHMiLCJsb2FkIiwiZXZlbnQiLCJ0YXJnZXQiLCJzZXRUaW1lb3V0IiwiY29uc29sZSIsImxvZyIsIm9wdGlvbnMiLCJvbmNlIiwib2JzZXJ2ZUNoYW5nZXMiLCJub1BvbHlmaWxsIiwib25DbGlja01lbnVUb2dnbGUiLCJ0b2dnbGUiLCJjbG9zZU1lbnUiLCJ2YWx1ZSIsInRvcCIsIm1hbmFnZUNvbnRyb2xzIiwicHJldkNzc0NsYXNzIiwibmV4dENzc0NsYXNzIiwiY3VycmVudFNsaWRlciIsImluZGV4IiwibGVuZ3RoIiwicHJldkJ0biIsIm5leHRCdG4iLCJzZXJ2aWNlc1NsaWRlciIsImJyZWFrcG9pbnRDaGVja2VyIiwibWF0Y2hlcyIsImVuYWJsZVN3aXBlciIsInVuZGVmaW5lZCIsImRlc3Ryb3kiLCJTd2lwZXIiLCJhMTF5IiwicGFnaW5hdGlvbkJ1bGxldE1lc3NhZ2UiLCJicmVha3BvaW50cyIsIjI1MCIsInBhZ2luYXRpb24iLCJjbGlja2FibGUiLCJyZW5kZXJCdWxsZXQiLCJjbGFzc05hbWUiLCJzbGlkZXNQZXJWaWV3Iiwic2xpZGVzUGVyR3JvdXAiLCJzcGFjZUJldHdlZW4iLCJpbml0aWFsU2xpZGUiLCJzZXRXcmFwcGVyU2l6ZSIsImdyYWJDdXJzb3IiLCJ1cGRhdGVPbldpbmRvd1Jlc2l6ZSIsImNlbnRlcmVkU2xpZGVzIiwiY2VudGVyZWRTbGlkZXNCb3VuZHMiLCI3NjgiLCJjc3NXaWR0aEFuZEhlaWdodCIsImFkZExpc3RlbmVyIiwiY2FyZHNTbGlkZXIiLCJrZXlib2FyZENvbnRyb2wiLCJuYXZpZ2F0aW9uIiwibmV4dEVsIiwicHJldkVsIiwiMzg0Iiwib24iLCJbb2JqZWN0IE9iamVjdF0iLCJpbm5lcldpZHRoIiwic2xpZGVzIiwiY3NzIiwiMTE0MSIsIjEzMDAiLCIxNTAwIiwicmVhbEluZGV4IiwibW9kYWxTbGlkZXJPcHRpb25zIiwib2JzZXJ2ZXIiLCJmYWRlRWZmZWN0IiwiY3Jvc3NGYWRlIiwiZ2FsbGVyeVNsaWRlciIsImdhbGxlcnlMaXN0IiwiaW1hZ2VzIiwiQXJyYXkiLCJmcm9tIiwic3JjU2V0Iiwic3JjIiwiZ2V0TGF6eVNsaWRlIiwic2xpZGVFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsInNsaWRlU291cmNlIiwic2xpZGVJbWciLCJ2aWV3UG9ydCIsImdhbGxlcnlJdGVtIiwiY3JlYXRlRWxlbWVudCIsImRhdGFzZXQiLCJzcmNzZXQiLCJhcHBlbmRDaGlsZCIsIm9uQ2xpY2tSZW5kZXJTbGlkZXMiLCJzbGlkZXIiLCJpbm5lckhUTUwiLCJpIiwidXBkYXRlIiwic2xpZGVUbyIsImZvckVhY2giLCJnYWxsZXJ5VG9nZ2xlIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFVLEtBQ1ZDLE9BQVMsSUFDVEMsY0FBZ0IsR0FDaEJDLFlBQWMsR0FDZEMsUUFBVUMsU0FBU0MsY0FBYyxxQkFDakNDLFlBQWNGLFNBQVNDLGNBQWMsaUJBQ3JDRSxNQUFRSCxTQUFTQyxjQUFjLFVBQy9CRyxhQUFlSixTQUFTQyxjQUFjLGtCQUN0Q0ksWUFBY0wsU0FBU0MsY0FBYyx5QkFDckNLLGFBQWVOLFNBQVNDLGNBQWMsbUJBQ3RDTSxXQUFhUCxTQUFTQyxjQUFjLGdCQUNwQ08sV0FBYVIsU0FBU0MsY0FBYyx3QkFDcENRLFFBQVVULFNBQVNDLGNBQWMsb0JBQ2pDUyxjQUFnQlYsU0FBU1csaUJBQWlCLGtCQUMxQ0MsV0FBYVosU0FBU1csaUJBQWlCLGdCQUN2Q0UsWUFBY2IsU0FBU0MsY0FBYyxpQkFDckNhLGdCQUFrQmQsU0FBU0MsY0FBYyw0QkFDekNjLFFBQVVDLE9BQU9DLFdBQVcsdUJBQzVCQyxVQUFZbEIsU0FBU0MsY0FBYyxTQUN6QyxJQUFJa0IsY0FBZ0JuQixTQUFTQyxjQUFjLDBCQUN2Q21CLEtBQU8sS0FDVEMsS0FBTyxLQUNMQyxLQUFPLEVBSVgsTUFBTUMsV0FBYSxTQUFVQyxFQUFLQyxHQXZCZCxLQXdCZEQsRUFBSUUsU0FDTkQsS0FNRUUsVUFBWSxDQUFDQyxFQUFJQyxLQUNyQkQsRUFBR0UsVUFBVUMsSUFBSSxlQUNqQkgsRUFBR0ksYUFBYSxjQUFjLEdBQzlCSixFQUFHSyxnQkFBZ0IsZUFDZjdCLGVBQ0ZBLGFBQWE4QixNQUFNQyxRQUFVLFNBRS9CQyxzQkFDQUMsYUFBYVIsUUFBUUEsSUFHakJTLFdB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c0NvbnRlbnQiOlsiY29uc3QgREVTS1RPUCA9IDExNDA7XG5jb25zdCBUQUJMRVQgPSA3Njc7XG5jb25zdCBFTlRFUl9LRVlDT0RFID0gMTM7XG5jb25zdCBFU0NfS0VZQ09ERSA9IDI3O1xuY29uc3QgbWVudUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGFnZS1oZWFkZXJfX2J0blwiKTtcbmNvbnN0IG1lbnVPdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51LW92ZXJsYXlcIik7XG5jb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxcIik7XG5jb25zdCBtb2RhbE92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLW92ZXJsYXlcIik7XG5jb25zdCBjb250YWN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFjdC1mb3JtX19maWVsZHNcIik7XG5jb25zdCBzZXJ2aWNlc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlcnZpY2VzX19saXN0XCIpO1xuY29uc3QgY2FsbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FsbC1idXR0b25cIik7XG5jb25zdCBtb2RhbENsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250YWN0LWZvcm1fX2Nsb3NlXCIpO1xuY29uc3QgaW50cm9CZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW50cm9fX2JnLWltYWdlXCIpO1xuY29uc3QgZ2FsbGVyeUltYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZ2FsbGVyeV9faXRlbVwiKTtcbmNvbnN0IGNhcmRTbGlkZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhcmRfX3NsaWRlXCIpO1xuY29uc3QgbW9kYWxTbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLXNsaWRlclwiKTtcbmNvbnN0IGdhbGxlcnlDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtc2xpZGVyX19jbG9zZS1idG5cIik7XG5jb25zdCBkZXNrdG9wID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWluLXdpZHRoOiAxMTQwcHgpXCIpO1xuY29uc3QgbXNucnlHcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkXCIpO1xubGV0IHNsaWRlVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLXNsaWRlci10ZW1wbGF0ZVwiKTtcbmxldCB3aW5YID0gbnVsbCxcbiAgd2luWSA9IG51bGw7XG5sZXQgc3RlcCA9IDE7XG5cbi8vICog0KTRg9C90LrRhtC40Y8g0L7QsdGA0LDQsdC+0YLQutC4INC90LDQttCw0YLQuNGPIGVzY1xuXG5jb25zdCBvbkVzY0V2ZW50ID0gZnVuY3Rpb24gKGV2dCwgYWN0aW9uKSB7XG4gIGlmIChldnQua2V5Q29kZSA9PT0gRVNDX0tFWUNPREUpIHtcbiAgICBhY3Rpb24oKTtcbiAgfVxufTtcblxuLy8gISDQpNGD0L3QutGG0LjRjyDQvtGC0LrRgNGL0YLQuNGPINC80L7QtNCw0LvRjNC90L7Qs9C+INC+0LrQvdCwXG5cbmNvbnN0IG9wZW5Nb2RhbCA9IChlbCwgY2FwdHVyZSkgPT4ge1xuICBlbC5jbGFzc0xpc3QuYWRkKFwibW9kYWwtLW9wZW5cIik7XG4gIGVsLnNldEF0dHJpYnV0ZShcImFyaWEtbW9kYWxcIiwgdHJ1ZSk7XG4gIGVsLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIpO1xuICBpZiAobW9kYWxPdmVybGF5KSB7XG4gICAgbW9kYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gIH1cbiAgZGlzYWJsZVdpbmRvd1Njcm9sbCgpO1xuICBmb2N1c01hbmFnZXIuY2FwdHVyZShjYXB0dXJlKTtcbn07XG5cbmNvbnN0IGNsb3NlTW9kYWwgPSAoZWwsIGNhcHR1cmUpID0+IHtcbiAgaWYgKGVsLmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsLS1vcGVuXCIpKSB7XG4gICAgZWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLS1vcGVuXCIpO1xuICAgIGVsLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtbW9kYWxcIik7XG4gICAgZWwuc2V0QXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIiwgdHJ1ZSk7XG4gICAgZW5hYmxlV2luZG93U2Nyb2xsKCk7XG4gICAgZm9jdXNNYW5hZ2VyLnJlbGVhc2UoY2FwdHVyZSk7XG4gIH1cblxuICBpZiAobW9kYWxPdmVybGF5KSB7XG4gICAgbW9kYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgfVxufTtcblxuLy8gISDQpNGD0L3QutGG0LjRjyDQsdC70L7QutC40YDQvtCy0LrQuCDRgdC60YDQvtC70LvQsFxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBmdW5jdGlvbiAoKSB7XG4gIGlmICh3aW5YICE9PSBudWxsICYmIHdpblkgIT09IG51bGwpIHtcbiAgICB3aW5kb3cuc2Nyb2xsVG8od2luWCwgd2luWSk7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBkaXNhYmxlV2luZG93U2Nyb2xsKCkge1xuICB3aW5YID0gd2luZG93LnNjcm9sbFg7XG4gIHdpblkgPSB3aW5kb3cuc2Nyb2xsWTtcbn1cblxuZnVuY3Rpb24gZW5hYmxlV2luZG93U2Nyb2xsKCkge1xuICB3aW5YID0gbnVsbDtcbiAgd2luWSA9IG51bGw7XG59XG5cbi8vICEg0JjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y8gTWFzb25yeSDQuCBZYWxsXG5cbmlmIChtc25yeUdyaWQpIHtcbiAgY29uc3QgZ3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZFwiKTtcblxuICBsZXQgbXNucnkgPSBuZXcgTWFzb25yeShncmlkLCB7XG4gICAgY29sdW1uV2lkdGg6IFwiLmdyaWQtc2l6ZXJcIixcbiAgICBpdGVtU2VsZWN0b3I6IFwiLmdyaWQtaXRlbVwiLFxuICAgIHBlcmNlbnRQb3NpdGlvbjogdHJ1ZSxcbiAgICB0cmFuc2l0aW9uRHVyYXRpb246IFwiMC4yc1wiXG4gIH0pO1xuXG4gIGZ1bmN0aW9uIGRvTWFzb25yeSgpIHtcbiAgICBtc25yeS5sYXlvdXQoKTtcbiAgfTtcblxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PlxuICAgIHlhbGwoe1xuICAgICAgZXZlbnRzOiB7XG4gICAgICAgIGxvYWQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZ2FsbGVyeV9faW1hZ2UtLXVubG9hZGVkXCIpKSB7XG4gICAgICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShcImdhbGxlcnlfX2ltYWdlLS11bmxvYWRlZFwiKTtcbiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGRvTWFzb25yeSwgMzAwKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZ2FsbGVyeV9faW1hZ2UtLXVubG9hZGVkXCIpXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgIH1cbiAgICB9KVxuICApO1xufSBlbHNlIHtcblxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PlxuICAgIHlhbGwoe1xuICAgICAgb2JzZXJ2ZUNoYW5nZXM6IHRydWUsXG4gICAgICBub1BvbHlmaWxsOiB0cnVlLFxuICAgIH0pXG4gICk7XG59XG5cbi8vICEg0J/QtdGA0LXQutC70Y7Rh9C10L3QuNC1INC80LXQvdGOXG5cbmlmIChtZW51QnRuICYmIG1lbnVPdmVybGF5KSB7XG4gIGNvbnN0IG9uQ2xpY2tNZW51VG9nZ2xlID0gKCkgPT4ge1xuICAgIG1lbnVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInBhZ2UtaGVhZGVyX19idG4tLWNsb3NlXCIpO1xuICAgIG1lbnVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInBhZ2UtaGVhZGVyX19idG4tLW9wZW5cIik7XG4gICAgbWVudU92ZXJsYXkuY2xhc3NMaXN0LnRvZ2dsZShcIm1lbnUtb3ZlcmxheS0tc2hvd25cIik7XG4gICAgaWYgKG1lbnVPdmVybGF5LmNsYXNzTGlzdC5jb250YWlucyhcIm1lbnUtb3ZlcmxheS0tc2hvd25cIikpIHtcbiAgICAgIGRpc2FibGVXaW5kb3dTY3JvbGwoKTtcbiAgICAgIGZvY3VzTWFuYWdlci5jYXB0dXJlKG1lbnVPdmVybGF5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgZW5hYmxlV2luZG93U2Nyb2xsKCk7XG4gICAgICBmb2N1c01hbmFnZXIucmVsZWFzZShtZW51T3ZlcmxheSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGNsb3NlTWVudSA9ICgpID0+IHtcbiAgICBpZiAobWVudU92ZXJsYXkuY2xhc3NMaXN0LmNvbnRhaW5zKFwibWVudS1vdmVybGF5LS1zaG93blwiKSkge1xuICAgICAgbWVudU92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShcIm1lbnUtb3ZlcmxheS0tc2hvd25cIik7XG4gICAgICBtZW51QnRuLmNsYXNzTGlzdC50b2dnbGUoXCJwYWdlLWhlYWRlcl9fYnRuLS1jbG9zZVwiKTtcbiAgICAgIG1lbnVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInBhZ2UtaGVhZGVyX19idG4tLW9wZW5cIik7XG4gICAgfVxuICB9O1xuXG4gIG1lbnVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQ2xpY2tNZW51VG9nZ2xlKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldnQpID0+IHtcbiAgICBvbkVzY0V2ZW50KGV2dCwgY2xvc2VNZW51KTtcbiAgfSk7XG59XG5cbi8vICEgSW50cm8gYmcgcGFyYWxsYXhcbmlmIChpbnRyb0JnICE9PSBudWxsKSB7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsICgpID0+IHtcbiAgICBsZXQgdmFsdWUgPSB3aW5kb3cuc2Nyb2xsWTtcblxuICAgIGludHJvQmcuc3R5bGUudG9wID0gdmFsdWUgKiAwLjUgKyBcInB4XCI7XG4gIH0pO1xufVxuXG4vLyAhINCS0YvQt9C+0LIg0Lgg0LfQsNC60YDRi9GC0LjQtSDQvNC+0LTQsNC70YzQvdC+0LPQviDQvtC60L3QsFxuaWYgKGNhbGxCdXR0b24gJiYgbW9kYWwgJiYgbW9kYWxDbG9zZSAmJiBtb2RhbE92ZXJsYXkpIHtcbiAgLy8g0J7QsdGA0LDQsdC+0YLRh9C40LrQuCDQtNC10LnRgdGC0LLQuNC5INC80L7QtNCw0LvRjNC90L7Qs9C+INC+0LrQvdCwXG5cbiAgY2FsbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gb3Blbk1vZGFsKG1vZGFsLCBjb250YWN0Rm9ybSkpO1xuXG4gIG1vZGFsQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwsIGNhbGxCdXR0b24pKTtcblxuICBtb2RhbE92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwsIGNhbGxCdXR0b24pKTtcblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGV2dCkgPT4ge1xuICAgIG9uRXNjRXZlbnQoZXZ0LCBjbG9zZU1vZGFsKG1vZGFsLCBjYWxsQnV0dG9uKSk7XG4gIH0pO1xufVxuXG4vLyAhINCk0YPQvdC60YbQuNGPINC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0LrQvdC+0L/QutC4INGB0LvQsNC50LTQtdGA0LBcblxuY29uc3QgbWFuYWdlQ29udHJvbHMgPSAoXG4gIHByZXZDc3NDbGFzcyxcbiAgbmV4dENzc0NsYXNzLFxuICBjdXJyZW50U2xpZGVyLFxuICBpbmRleCxcbiAgbGVuZ3RoXG4pID0+IHtcbiAgY29uc3QgcHJldkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJldkNzc0NsYXNzKTtcbiAgY29uc3QgbmV4dEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmV4dENzc0NsYXNzKTtcblxuICBpZiAocHJldkJ0biAmJiBjdXJyZW50U2xpZGVyICYmIGluZGV4ID4gMCkge1xuICAgIHByZXZCdG4uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICBuZXh0QnRuLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gIH1cblxuICBpZiAocHJldkJ0biAmJiBjdXJyZW50U2xpZGVyICYmIGluZGV4ID09PSAwKSB7XG4gICAgcHJldkJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgbmV4dEJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICB9XG5cbiAgaWYgKHByZXZCdG4gJiYgY3VycmVudFNsaWRlciAmJiBpbmRleCA9PT0gbGVuZ3RoIC0gMSkge1xuICAgIG5leHRCdG4uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICB9XG59O1xuXG4vLyAhINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINGB0LvQsNC50LTQtdGA0LAg0LTQu9GPINCx0LvQvtC60LAg4oCY0KPRgdC70YPQs9C44oCYXG5cbmxldCBzZXJ2aWNlc1NsaWRlcjtcblxuY29uc3QgYnJlYWtwb2ludENoZWNrZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGlmIChkZXNrdG9wLm1hdGNoZXMgPT09IHRydWUpIHtcbiAgICBpZiAoc2VydmljZXNTbGlkZXIgIT09IHVuZGVmaW5lZCAmJiBzZXJ2aWNlc0xpc3QpXG4gICAgICBzZXJ2aWNlc1NsaWRlci5kZXN0cm95KHRydWUsIHRydWUpO1xuXG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGRlc2t0b3AubWF0Y2hlcyA9PT0gZmFsc2UpIHtcbiAgICByZXR1cm4gZW5hYmxlU3dpcGVyKCk7XG4gIH1cbn07XG5cbmNvbnN0IGVuYWJsZVN3aXBlciA9IGZ1bmN0aW9uICgpIHtcbiAgc2VydmljZXNTbGlkZXIgPSBuZXcgU3dpcGVyKFwiLnN3aXBlcjFcIiwge1xuICAgIGExMXk6IHRydWUsXG4gICAgcGFnaW5hdGlvbkJ1bGxldE1lc3NhZ2U6IFwi0J/QtdGA0LXQudGC0Lgg0Log0YHQu9Cw0LnQtNGDIHt7aW5kZXh9fVwiLFxuXG4gICAgYnJlYWtwb2ludHM6IHtcbiAgICAgIDI1MDoge1xuICAgICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgICAgZWw6IFwiLnN3aXBlci1wYWdpbmF0aW9uXCIsXG4gICAgICAgICAgY2xpY2thYmxlOiB0cnVlLFxuICAgICAgICAgIHJlbmRlckJ1bGxldDogZnVuY3Rpb24gKGluZGV4LCBjbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiJyArXG4gICAgICAgICAgICAgIGNsYXNzTmFtZSArXG4gICAgICAgICAgICAgICdcIiBhcmlhLWxhYmVsPSBcIicgK1xuICAgICAgICAgICAgICBcItCf0LXRgNC10LnRgtC4INC6INGB0LvQsNC50LTRgyBcIiArXG4gICAgICAgICAgICAgIGluZGV4ICtcbiAgICAgICAgICAgICAgJ1wiPicgK1xuICAgICAgICAgICAgICBcItCf0LXRgNC10LnRgtC4INC6INGB0LvQsNC50LTRgyBcIiArXG4gICAgICAgICAgICAgIGluZGV4ICtcbiAgICAgICAgICAgICAgXCI8L2J1dHRvbj5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgICAgIHNsaWRlc1Blckdyb3VwOiAxLFxuICAgICAgICBzcGFjZUJldHdlZW46IDI4LFxuICAgICAgICBpbml0aWFsU2xpZGU6IDAsXG4gICAgICAgIHNldFdyYXBwZXJTaXplOiB0cnVlLFxuICAgICAgICBncmFiQ3Vyc29yOiB0cnVlLFxuICAgICAgICB1cGRhdGVPbldpbmRvd1Jlc2l6ZTogdHJ1ZSxcbiAgICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXG4gICAgICAgIGNlbnRlcmVkU2xpZGVzQm91bmRzOiB0cnVlLFxuICAgICAgfSxcblxuICAgICAgNzY4OiB7XG4gICAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgICBlbDogXCIuc3dpcGVyLXBhZ2luYXRpb25cIixcbiAgICAgICAgICBjbGlja2FibGU6IHRydWUsXG4gICAgICAgICAgcmVuZGVyQnVsbGV0OiBmdW5jdGlvbiAoaW5kZXgsIGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCInICtcbiAgICAgICAgICAgICAgY2xhc3NOYW1lICtcbiAgICAgICAgICAgICAgJ1wiIGFyaWEtbGFiZWw9IFwiJyArXG4gICAgICAgICAgICAgIFwi0J/QtdGA0LXQudGC0Lgg0Log0YHQu9Cw0LnQtNGDIFwiICtcbiAgICAgICAgICAgICAgaW5kZXggK1xuICAgICAgICAgICAgICAnXCI+JyArXG4gICAgICAgICAgICAgIFwi0J/QtdGA0LXQudGC0Lgg0Log0YHQu9Cw0LnQtNGDIFwiICtcbiAgICAgICAgICAgICAgaW5kZXggK1xuICAgICAgICAgICAgICBcIjwvYnV0dG9uPlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2xpZGVzUGVyVmlldzogMixcbiAgICAgICAgc2xpZGVzUGVyR3JvdXA6IDIsXG4gICAgICAgIGluaXRpYWxTbGlkZTogMCxcbiAgICAgICAgc2V0V3JhcHBlclNpemU6IHRydWUsXG4gICAgICAgIGdyYWJDdXJzb3I6IHRydWUsXG4gICAgICAgIHVwZGF0ZU9uV2luZG93UmVzaXplOiB0cnVlLFxuICAgICAgICBjc3NXaWR0aEFuZEhlaWdodDogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG59O1xuXG5kZXNrdG9wLmFkZExpc3RlbmVyKGJyZWFrcG9pbnRDaGVja2VyKTtcblxuYnJlYWtwb2ludENoZWNrZXIoKTtcblxuLy8gISDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyDRgdC70LDQudC00LXRgNCwINC60LDRgNGC0L7Rh9C10Log0YPRgdC70YPQs1xuXG5sZXQgY2FyZHNTbGlkZXIgPSBuZXcgU3dpcGVyKFwiLnN3aXBlcjJcIiwge1xuICBzbGlkZXNQZXJWaWV3OiA0LFxuICBzbGlkZXNQZXJHcm91cDogNCxcbiAgaW5pdGlhbFNsaWRlOiAwLFxuICBzcGFjZUJldHdlZW46IDIwLFxuICBhMTF5OiB0cnVlLFxuICBwYWdpbmF0aW9uQnVsbGV0TWVzc2FnZTogXCLQn9C10YDQtdC50YLQuCDQuiDRgdC70LDQudC00YMge3tpbmRleH19XCIsXG4gIGtleWJvYXJkQ29udHJvbDogdHJ1ZSxcbiAgZ3JhYkN1cnNvcjogdHJ1ZSxcbiAgdXBkYXRlT25XaW5kb3dSZXNpemU6IHRydWUsXG4gIG5hdmlnYXRpb246IHtcbiAgICBuZXh0RWw6IFwiLmNhcmRfX2NvbnRyb2wtLW5leHRcIixcbiAgICBwcmV2RWw6IFwiLmNhcmRfX2NvbnRyb2wtLXByZXZcIixcbiAgfSxcbiAgLy8gY3NzV2lkdGhBbmRIZWlnaHQ6IHRydWUsXG5cbiAgYnJlYWtwb2ludHM6IHtcbiAgICAyNTA6IHtcbiAgICAgIHNwYWNlQmV0d2VlbjogMTUsXG4gICAgICBpbml0aWFsU2xpZGU6IDAsXG4gICAgICBrZXlib2FyZENvbnRyb2w6IHRydWUsXG4gICAgICBncmFiQ3Vyc29yOiB0cnVlLFxuICAgICAgdXBkYXRlT25XaW5kb3dSZXNpemU6IHRydWUsXG4gICAgfSxcblxuICAgIDM4NDoge1xuICAgICAgaW5pdGlhbFNsaWRlOiAwLFxuICAgICAgb246IHtcbiAgICAgICAgYmVmb3JlUmVzaXplKCkge1xuICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSAzODQpIHtcbiAgICAgICAgICAgIGNhcmRzU2xpZGVyLnNsaWRlcy5jc3MoXCJ3aWR0aFwiLCBcIlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG5cbiAgICA3Njg6IHtcbiAgICAgIHNsaWRlc1BlclZpZXc6IDQsXG4gICAgICBzbGlkZXNQZXJHcm91cDogNCxcbiAgICAgIGluaXRpYWxTbGlkZTogMCxcbiAgICAgIHNwYWNlQmV0d2VlbjogMjMsXG4gICAgICBzZXRXcmFwcGVyU2l6ZTogdHJ1ZSxcbiAgICAgIGtleWJvYXJkQ29udHJvbDogdHJ1ZSxcbiAgICAgIGdyYWJDdXJzb3I6IHRydWUsXG4gICAgICB1cGRhdGVPbldpbmRvd1Jlc2l6ZTogdHJ1ZSxcbiAgICAgIGNzc1dpZHRoQW5kSGVpZ2h0OiB0cnVlLFxuICAgIH0sXG5cbiAgICAxMTQxOiB7XG4gICAgICBzcGFjZUJldHdlZW46IDksXG4gICAgfSxcblxuICAgIDEzMDA6IHtcbiAgICAgIHNwYWNlQmV0d2VlbjogMTIsXG4gICAgfSxcblxuICAgIDE1MDA6IHtcbiAgICAgIHNwYWNlQmV0d2VlbjogMTYsXG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vLyAqINCe0LHRgNCw0LHQvtGC0YfQuNC6INGB0LzQtdC90Ysg0YHQu9Cw0LnQtNC+0LJcblxuY2FyZHNTbGlkZXIub24oXCJzbGlkZUNoYW5nZVwiLCAoKSA9PlxuICBtYW5hZ2VDb250cm9scyhcbiAgICBcIi5jYXJkX19jb250cm9sLS1wcmV2XCIsXG4gICAgXCIuY2FyZF9fY29udHJvbC0tbmV4dFwiLFxuICAgIGNhcmRzU2xpZGVyLFxuICAgIGNhcmRzU2xpZGVyLnJlYWxJbmRleCxcbiAgICBjYXJkU2xpZGVzLmxlbmd0aFxuICApXG4pO1xuXG4vLyAhINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINC80L7QtNCw0LvRjNC90L7Qs9C+INGB0LvQsNC50LTQtdGA0LBcblxubGV0IG1vZGFsU2xpZGVyT3B0aW9ucyA9IHtcbiAgc2xpZGVzUGVyVmlldzogMSxcbiAgc2xpZGVzUGVyR3JvdXA6IDEsXG4gIGExMXk6IHRydWUsXG4gIGluaXRpYWxTbGlkZTogMCxcbiAgb2JzZXJ2ZXI6IHRydWUsXG4gIHVwZGF0ZU9uV2luZG93UmVzaXplOiB0cnVlLFxuICBuYXZpZ2F0aW9uOiB7XG4gICAgbmV4dEVsOiBcIi5tb2RhbC1idG4tLW5leHRcIixcbiAgICBwcmV2RWw6IFwiLm1vZGFsLWJ0bi0tcHJldlwiLFxuICB9LFxuICBmYWRlRWZmZWN0OiB7XG4gICAgY3Jvc3NGYWRlOiB0cnVlLFxuICB9LFxufTtcblxuY29uc3QgZ2FsbGVyeVNsaWRlciA9IG5ldyBTd2lwZXIoXCIuc3dpcGVyM1wiLCBtb2RhbFNsaWRlck9wdGlvbnMpO1xuXG4vLyAhINCU0L7QsdCw0LLQu9C10L3QuNC1INGB0LvQsNC50LTQvtCyXG5cbmlmIChtb2RhbCAmJiBnYWxsZXJ5SW1hZ2VzICYmIG1vZGFsU2xpZGVyKSB7XG4gIGxldCBnYWxsZXJ5TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3dpcGVyLXdyYXBwZXJcIik7XG5cbiAgaWYgKHNsaWRlVGVtcGxhdGUpIHtcbiAgICBjb25zdCBpbWFnZXMgPSBBcnJheS5mcm9tKGdhbGxlcnlJbWFnZXMpO1xuICAgIGxldCBzcmNTZXQ7XG4gICAgbGV0IHNyYztcblxuICAgIC8vICog0KTRg9C90LrRhtC40Y8g0YHQvtC30LTQsNC90LjRjyDRgdC70LDQudC00LBcblxuICAgIGNvbnN0IGdldExhenlTbGlkZSA9IChpbmRleCkgPT4ge1xuICAgICAgbGV0IHNsaWRlRWxlbWVudCA9IHNsaWRlVGVtcGxhdGUuY29udGVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1zbGlkZXJfX3BpY3R1cmVcIilcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIGxldCBzbGlkZVNvdXJjZSA9IHNsaWRlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwic291cmNlXCIpO1xuICAgICAgbGV0IHNsaWRlSW1nID0gc2xpZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbWdcIik7XG4gICAgICBsZXQgdmlld1BvcnQgPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgIGxldCBnYWxsZXJ5SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcblxuICAgICAgZ2FsbGVyeUl0ZW0uY2xhc3NMaXN0LmFkZChcIm1vZGFsLXNsaWRlcl9faXRlbVwiKTtcbiAgICAgIGdhbGxlcnlJdGVtLmNsYXNzTGlzdC5hZGQoXCJzd2lwZXItc2xpZGVcIik7XG5cbiAgICAgIGlmICh2aWV3UG9ydCA+IFRBQkxFVCkge1xuICAgICAgICBzcmNTZXQgPSBgaW1nL2dhbGxlcnkvdGFibGV0L2dhbGxlcnktaW1nLSR7aW5kZXh9LS10YWJsZXQud2VicCAxeCwgaW1nL2dhbGxlcnkvdGFibGV0L2dhbGxlcnktaW1nLSR7aW5kZXh9LS10YWJsZXRAMngud2VicCAyeGA7XG5cbiAgICAgICAgc3JjID0gYGltZy9nYWxsZXJ5L3RhYmxldC9nYWxsZXJ5LWltZy0ke2luZGV4fS0tdGFibGV0LmpwZ2A7XG5cbiAgICAgICAgc2xpZGVTb3VyY2UuZGF0YXNldC5zcmNzZXQgPSBzcmNTZXQ7XG4gICAgICAgIHNsaWRlSW1nLmRhdGFzZXQuc3JjID0gc3JjO1xuICAgICAgICBnYWxsZXJ5SXRlbS5hcHBlbmRDaGlsZChzbGlkZUVsZW1lbnQpO1xuXG4gICAgICAgIGdhbGxlcnlMaXN0LmFwcGVuZENoaWxkKGdhbGxlcnlJdGVtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNyY1NldCA9IGBpbWcvZ2FsbGVyeS9tb2JpbGUvZ2FsbGVyeS1pbWctJHtpbmRleH0tLW1vYmlsZS53ZWJwIDF4LCBpbWcvZ2FsbGVyeS9tb2JpbGUvZ2FsbGVyeS1pbWctJHtpbmRleH0tLW1vYmlsZUAyeC53ZWJwIDJ4YDtcblxuICAgICAgICBzcmMgPSBgaW1nL2dhbGxlcnkvbW9iaWxlL2dhbGxlcnktaW1nLSR7aW5kZXh9LS1tb2JpbGUuanBnYDtcblxuICAgICAgICBzbGlkZVNvdXJjZS5kYXRhc2V0LnNyY3NldCA9IHNyY1NldDtcbiAgICAgICAgc2xpZGVJbWcuZGF0YXNldC5zcmMgPSBzcmM7XG4gICAgICAgIGdhbGxlcnlJdGVtLmFwcGVuZENoaWxkKHNsaWRlRWxlbWVudCk7XG5cbiAgICAgICAgZ2FsbGVyeUxpc3QuYXBwZW5kQ2hpbGQoZ2FsbGVyeUl0ZW0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyAqINCk0YPQvdC60YbQuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC6INGB0LzQtdC90Ysg0YHQu9Cw0LnQtNC+0LJcblxuICAgIGNvbnN0IG9uQ2xpY2tSZW5kZXJTbGlkZXMgPSAoaW5kZXgsIHNsaWRlcikgPT4ge1xuICAgICAgbGV0IGNsZWFyU2xpZGVzID0gKCkgPT4gKGdhbGxlcnlMaXN0LmlubmVySFRNTCA9IFwiXCIpO1xuXG4gICAgICBjbGVhclNsaWRlcygpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBnYWxsZXJ5SW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdldExhenlTbGlkZShpKTtcbiAgICAgIH1cblxuICAgICAgc2xpZGVyLnVwZGF0ZSgpO1xuICAgICAgc2xpZGVyLnNsaWRlVG8oaW5kZXgpO1xuICAgIH07XG5cbiAgICAvLyAqINCe0LHRgNCw0LHQvtGC0LrQsCDQtNC10LnRgdGC0LLQuNC5INC/0L4g0L3QsNC20LDRgtC40Y4g0L3QsCDQuNC30L7QsdGA0LDQttC10L3QuNGPXG5cbiAgICBpbWFnZXMuZm9yRWFjaCgoZ2FsbGVyeVRvZ2dsZSwgaW5kZXgpID0+IHtcbiAgICAgIGdhbGxlcnlUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgb25DbGlja1JlbmRlclNsaWRlcyhpbmRleCwgZ2FsbGVyeVNsaWRlcik7XG4gICAgICAgIG9wZW5Nb2RhbChtb2RhbCwgbW9kYWxTbGlkZXIpO1xuXG4gICAgICAgIG1hbmFnZUNvbnRyb2xzKFxuICAgICAgICAgIFwiLm1vZGFsLWJ0bi0tcHJldlwiLFxuICAgICAgICAgIFwiLm1vZGFsLWJ0bi0tbmV4dFwiLFxuICAgICAgICAgIGdhbGxlcnlTbGlkZXIsXG4gICAgICAgICAgZ2FsbGVyeVNsaWRlci5yZWFsSW5kZXgsXG4gICAgICAgICAgZ2FsbGVyeUltYWdlcy5sZW5ndGhcbiAgICAgICAgKTtcblxuICAgICAgICB5YWxsKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGdhbGxlcnlDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChtb2RhbCwgd2luZG93KSk7XG4gICAgbW9kYWxPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKG1vZGFsLCB3aW5kb3cpKTtcblxuICAgIGdhbGxlcnlTbGlkZXIub24oXCJzbGlkZUNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICBtYW5hZ2VDb250cm9scyhcbiAgICAgICAgXCIubW9kYWwtYnRuLS1wcmV2XCIsXG4gICAgICAgIFwiLm1vZGFsLWJ0bi0tbmV4dFwiLFxuICAgICAgICBnYWxsZXJ5U2xpZGVyLFxuICAgICAgICBnYWxsZXJ5U2xpZGVyLnJlYWxJbmRleCxcbiAgICAgICAgZ2FsbGVyeUltYWdlcy5sZW5ndGhcbiAgICAgICk7XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==
